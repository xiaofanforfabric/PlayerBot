# FanMacro GUI 更新日志

## v1.1 - 自动连接和顺序调整功能

### ✅ 新增功能

#### 1. 自动连接功能
- **拖拽自动连接**：拖拽积木靠近其他积木时，会自动检测并高亮显示可连接的积木
- **视觉反馈**：可连接的积木会显示绿色边框高亮
- **自动对齐**：连接后积木会自动对齐位置（垂直排列，X坐标对齐）
- **连接距离**：80像素范围内自动连接

#### 2. 顺序调整功能
- **右键菜单**：右键点击积木显示操作菜单
  - **上移**：将积木在连接链中向上移动一个位置
  - **下移**：将积木在连接链中向下移动一个位置
  - **断开连接**：断开当前积木与下一块积木的连接
  - **删除**：删除积木
- **自动重排**：调整顺序后，积木位置会自动对齐

#### 3. 改进的代码生成
- **按连接顺序生成**：代码现在按照积木的连接顺序生成，而不是画布位置
- **多链支持**：支持多个独立的积木链
- **智能识别**：自动识别函数定义和主程序

### 🔧 技术改进

1. **双向链表**：积木之间使用双向链表连接，便于遍历和调整
2. **实时反馈**：拖拽时实时显示可连接的积木
3. **自动对齐**：连接后自动调整位置，保持整齐
4. **连接检测**：智能检测可以连接的积木（方向、距离）

### 📝 使用方法

#### 自动连接
1. 从左侧积木面板点击积木添加到画布
2. 拖拽积木靠近另一个积木（距离 < 80像素）
3. 可连接的积木会显示绿色高亮
4. 释放鼠标，积木自动连接并对齐

#### 调整顺序
1. 右键点击要调整的积木
2. 选择"上移"或"下移"
3. 积木会在连接链中移动位置
4. 代码预览实时更新

#### 断开连接
1. 右键点击积木
2. 选择"断开连接"
3. 积木断开与下一块积木的连接
4. 可以重新连接或创建新链

### 🎯 改进效果

**之前：**
- ❌ 积木无法自动连接
- ❌ 无法调整积木顺序
- ❌ 代码按画布位置生成，不准确

**现在：**
- ✅ 拖拽自动连接，操作更流畅
- ✅ 右键菜单调整顺序，灵活方便
- ✅ 代码按连接顺序生成，准确可靠

### 🚀 下一步计划

- [ ] 参数输入对话框（替换占位符）
- [ ] 代码到积木的反向解析
- [ ] 积木的复制和粘贴
- [ ] 撤销/重做功能
- [ ] 更丰富的积木类型

---

**版本：** v1.1  
**日期：** 2024  
**状态：** ✅ 已实现并测试通过

